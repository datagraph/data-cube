/*
The MIT License (MIT)

Copyright (c) Arve Seljebu <arve.seljebu@gmail.com> (arve0.github.io)
*/
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).markdownItAttrs=e()}}(function(){return function(){return function e(t,n,i){function r(s,o){if(!n[s]){if(!t[s]){var f="function"==typeof require&&require;if(!o&&f)return f(s,!0);if(l)return l(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var a=n[s]={exports:{}};t[s][0].call(a.exports,function(e){return r(t[s][1][e]||e)},a,a.exports,e,t,n,i)}return n[s].exports}for(var l="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}}()({1:[function(e,t,n){"use strict";const i=e("./patterns.js"),r={leftDelimiter:"{",rightDelimiter:"}"};function l(e,t,n){let i={match:!1,j:null},r=void 0!==n.shift?t+n.shift:n.position,c=(a=e,(h=r)>=0?a[h]:a[a.length+h]);var a,h;if(void 0===c)return i;for(let e in n)if("shift"!==e&&"position"!==e){if(void 0===c[e])return i;if("children"===e&&s(n.children)){if(0===c.children.length)return i;let e,t=n.children,r=c.children;if(t.every(e=>void 0!==e.position)){if(e=t.every(e=>l(r,e.position,e).match)){let e=f(t).position;i.j=e>=0?e:r.length+e}}else for(let n=0;n<r.length;n++)if(e=t.every(e=>l(r,n,e).match)){i.j=n;break}if(!1===e)return i}else switch(typeof n[e]){case"boolean":case"number":case"string":if(c[e]!==n[e])return i;break;case"function":if(!n[e](c[e]))return i;break;case"object":if(o(n[e])){if(!1===n[e].every(t=>t(c[e])))return i;break}default:throw new Error(`Unknown type of pattern test (key: ${e}). Test should be of type boolean, number, string, function or array of functions.`)}}return i.match=!0,i}function s(e){return Array.isArray(e)&&e.length&&e.every(e=>"object"==typeof e)}function o(e){return Array.isArray(e)&&e.length&&e.every(e=>"function"==typeof e)}function f(e){return e.slice(-1)[0]||{}}t.exports=function(e,t){t||(t=r);const n=i(t);e.core.ruler.before("linkify","curly_attributes",function(e){let t=e.tokens;for(let e=0;e<t.length;e++)for(let i=0;i<n.length;i++){let r=n[i],s=null;r.tests.every(n=>{let i=l(t,e,n);return null!==i.j&&(s=i.j),i.match})&&(r.transform(t,e,s),"inline attributes"!==r.name&&"inline nesting 0"!==r.name||i--)}})}},{"./patterns.js":2}],2:[function(e,t,n){"use strict";const i=e("./utils.js");function r(e){return e.slice(-1)[0]}t.exports=(e=>{const t=new RegExp("^ {0,3}[-*_]{3,} ?"+i.escapeRegExp(e.leftDelimiter)+"[^"+i.escapeRegExp(e.rightDelimiter)+"]");return[{name:"fenced code blocks",tests:[{shift:0,block:!0,info:i.hasDelimiters("end",e)}],transform:(t,n)=>{let r=t[n],l=r.info.lastIndexOf(e.leftDelimiter),s=i.getAttrs(r.info,l,e);i.addAttrs(s,r),r.info=i.removeDelimiter(r.info,e)}},{name:"inline nesting 0",tests:[{shift:0,type:"inline",children:[{shift:-1,type:e=>"image"===e||"code_inline"===e},{shift:0,type:"text",content:i.hasDelimiters("start",e)}]}],transform:(t,n,r)=>{let l=t[n].children[r],s=l.content.indexOf(e.rightDelimiter),o=t[n].children[r-1],f=i.getAttrs(l.content,0,e);i.addAttrs(f,o),l.content.length===s+e.rightDelimiter.length?t[n].children.splice(r,1):l.content=l.content.slice(s+e.rightDelimiter.length)}},{name:"tables",tests:[{shift:0,type:"table_close"},{shift:1,type:"paragraph_open"},{shift:2,type:"inline",content:i.hasDelimiters("only",e)}],transform:(t,n)=>{let r=t[n+2],l=i.getMatchingOpeningToken(t,n),s=i.getAttrs(r.content,0,e);i.addAttrs(s,l),t.splice(n+1,3)}},{name:"inline attributes",tests:[{shift:0,type:"inline",children:[{shift:-1,nesting:-1},{shift:0,type:"text",content:i.hasDelimiters("start",e)}]}],transform:(t,n,r)=>{let l=t[n].children[r],s=l.content,o=i.getAttrs(s,0,e),f=i.getMatchingOpeningToken(t[n].children,r-1);i.addAttrs(o,f),l.content=s.slice(s.indexOf(e.rightDelimiter)+e.rightDelimiter.length)}},{name:"list softbreak",tests:[{shift:-2,type:"list_item_open"},{shift:0,type:"inline",children:[{position:-2,type:"softbreak"},{position:-1,content:i.hasDelimiters("only",e)}]}],transform:(t,n,r)=>{let l=t[n].children[r].content,s=i.getAttrs(l,0,e),o=n-2;for(;t[o-1]&&"ordered_list_open"!==t[o-1].type&&"bullet_list_open"!==t[o-1].type;)o--;i.addAttrs(s,t[o-1]),t[n].children=t[n].children.slice(0,-2)}},{name:"list double softbreak",tests:[{shift:0,type:e=>"bullet_list_close"===e||"ordered_list_close"===e},{shift:1,type:"paragraph_open"},{shift:2,type:"inline",content:i.hasDelimiters("only",e),children:e=>1===e.length},{shift:3,type:"paragraph_close"}],transform:(t,n)=>{let r=t[n+2].content,l=i.getAttrs(r,0,e),s=i.getMatchingOpeningToken(t,n);i.addAttrs(l,s),t.splice(n+1,3)}},{name:"list item end",tests:[{shift:-2,type:"list_item_open"},{shift:0,type:"inline",children:[{position:-1,content:i.hasDelimiters("end",e)}]}],transform:(t,n,l)=>{let s=t[n].children[l],o=s.content,f=i.getAttrs(o,o.lastIndexOf(e.leftDelimiter),e);i.addAttrs(f,t[n-2]);let c=o.slice(0,o.lastIndexOf(e.leftDelimiter));s.content=" "!==r(c)?c:c.slice(0,-1)}},{name:"\n{.a} softbreak then curly in start",tests:[{shift:0,type:"inline",children:[{position:-2,type:"softbreak"},{position:-1,type:"text",content:i.hasDelimiters("only",e)}]}],transform:(t,n,r)=>{let l=t[n].children[r],s=i.getAttrs(l.content,0,e),o=n+1;for(;t[o+1]&&-1===t[o+1].nesting;)o++;let f=i.getMatchingOpeningToken(t,o);i.addAttrs(s,f),t[n].children=t[n].children.slice(0,-2)}},{name:"horizontal rule",tests:[{shift:0,type:"paragraph_open"},{shift:1,type:"inline",children:e=>1===e.length,content:e=>null!==e.match(t)},{shift:2,type:"paragraph_close"}],transform:(t,n)=>{let r=t[n];r.type="hr",r.tag="hr",r.nesting=0;let l=t[n+1].content,s=l.lastIndexOf(e.leftDelimiter);r.attrs=i.getAttrs(l,s,e),r.markup=l,t.splice(n+1,2)}},{name:"end of block",tests:[{shift:0,type:"inline",children:[{position:-1,content:i.hasDelimiters("end",e),type:e=>"code_inline"!==e}]}],transform:(t,n,l)=>{let s=t[n].children[l],o=s.content,f=i.getAttrs(o,o.lastIndexOf(e.leftDelimiter),e),c=n+1;for(;t[c+1]&&-1===t[c+1].nesting;)c++;let a=i.getMatchingOpeningToken(t,c);i.addAttrs(f,a);let h=o.slice(0,o.lastIndexOf(e.leftDelimiter));s.content=" "!==r(h)?h:h.slice(0,-1)}}]})},{"./utils.js":3}],3:[function(e,t,n){"use strict";function i(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}n.getAttrs=function(e,t,n){const i=/[^\t\n\f \/>"'=]/,r=[];let l="",s="",o=!0,f=!1;for(let c=t+n.leftDelimiter.length;c<e.length;c++){if(e.slice(c,c+n.rightDelimiter.length)===n.rightDelimiter){""!==l&&r.push([l,s]);break}let t=e.charAt(c);if("="===t&&o)o=!1;else if("."!==t||""!==l)if("#"!==t||""!==l)if('"'!==t||""!==s)if('"'===t&&f)f=!1;else if(" "!==t||f)o&&-1===t.search(i)||(o?l+=t:s+=t);else{if(""===l)continue;r.push([l,s]),l="",s="",o=!0}else f=!0;else l="id",o=!1;else"."===e.charAt(c+1)?(l="css-module",c+=1):l="class",o=!1}return r},n.addAttrs=function(e,t){for(let n=0,i=e.length;n<i;++n){let i=e[n][0];"class"===i?t.attrJoin("class",e[n][1]):"css-module"===i?t.attrJoin("css-module",e[n][1]):t.attrPush(e[n])}return t},n.hasDelimiters=function(e,t){if(!e)throw new Error('Parameter `where` not passed. Should be "start", "middle", "end" or "only".');return function(n){let i,r,l,s,o=t.leftDelimiter.length+1+t.rightDelimiter.length;if(!n||"string"!=typeof n||n.length<o)return!1;let f=o-t.rightDelimiter.length;switch(e){case"start":r=-1===(i=(l=n.slice(0,t.leftDelimiter.length))===t.leftDelimiter?0:-1)?-1:n.indexOf(t.rightDelimiter,f),(s=n.charAt(r+t.rightDelimiter.length))&&-1!==t.rightDelimiter.indexOf(s)&&(r=-1);break;case"end":r=(r=-1===(i=n.lastIndexOf(t.leftDelimiter))?-1:n.indexOf(t.rightDelimiter,i+f))===n.length-t.rightDelimiter.length?r:-1;break;case"only":i=(l=n.slice(0,t.leftDelimiter.length))===t.leftDelimiter?0:-1,r=(l=n.slice(n.length-t.rightDelimiter.length))===t.rightDelimiter?n.length-t.rightDelimiter.length:-1}return-1!==i&&-1!==r&&function(e){let n="."===e.charAt(t.leftDelimiter.length),i="#"===e.charAt(t.leftDelimiter.length);return n||i?e.length>=o+1:e.length>=o}(n.substring(i,r+t.rightDelimiter.length))}},n.removeDelimiter=function(e,t){const n=i(t.leftDelimiter),r=i(t.rightDelimiter);let l=new RegExp("[ \\n]?"+n+"[^"+n+r+"]+"+r+"$"),s=e.search(l);return-1!==s?e.slice(0,s):e},n.escapeRegExp=i,n.getMatchingOpeningToken=function(e,t){if("softbreak"===e[t].type)return!1;if(0===e[t].nesting)return e[t];let n=e[t].block?e[t].level:e[t].level+1,i=e[t].type.replace("_close","_open");for(;t>=0;--t)if(e[t].type===i&&e[t].level===n)return e[t]};let r=/[&<>"]/,l=/[&<>"]/g,s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function o(e){return s[e]}n.escapeHtml=function(e){return r.test(e)?e.replace(l,o):e}},{}]},{},[1])(1)});